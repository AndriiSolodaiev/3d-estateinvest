import $s3dVillaNavigation from '../../villa/villaNavigation';
import s3d2spriteIcon from '../../../../../../../s3d2/scripts/templates/spriteIcon';
import ButtonIconLeft from '../../../../../../../s3d2/scripts/templates/common/ButtonIconLeft';
import { numberWithCommas } from '../../../../../../../s3d2/scripts/helpers/helpers_s3d2';
import { TOOLTIP_ATTRIBUTE } from '../../../../../../../s3d2/scripts/constants';

export default function s3dFlatFloorDetails(
  i18n,
  flat,
  isChecked,
  flybyLists,
  labelsToShowInInfoBlock = [],
) {
  const { build, floor, number, type, sale, rooms, area, _price, price_m2 } = flat;

  const buildContent =
    build && build != 0
      ? `<div><span>${i18n.t(`Flat.information.build`)}</span>: <span> ${build}</span></div>`
      : '';
  const floordContent =
    floor && floor != 0
      ? `<div><span>${i18n.t(`Flat.information.floor`)}</span>: <span> ${floor}</span></div>`
      : '';
  const numberdContent =
    number && number != 0
      ? `<div><span>${i18n.t(`Flat.information.number`)}</span>: <span> ${number}</span></div>`
      : '';
  const typeContent =
    type && type != 0
      ? `<div><span>${i18n.t(`Flat.information.type`)}</span>: <span> ${type}</span></div>`
      : '';
  const areaContent =
    rooms && area && rooms != 0 && area != 0
      ? `<div class="s3d-flat-new__details-area">
        <span>${rooms}${i18n.t(
          `Flat.information.rooms_R`,
        )}</span><span>/</span><span>${area}${i18n.t(`area_unit`)}</span></div>`
      : '';

  const firstFlyby = flybyLists.find(el => Array.isArray(el) && el.length > 0);

  const $infoLabels = labelsToShowInInfoBlock.map(labelObj => {
    if (!labelObj || !labelObj.label || !labelObj.key || flat[labelObj.key] === undefined) {
      if (flat[labelObj.key] === undefined)
        console.warn(`[WARN] Key "${labelObj.key}" is not found in flat object.`);
      return '';
    }

    return `
      <div><span>${i18n.t(labelObj.label)}</span>: <span>${flat[labelObj.key]}</span></div>
    `;
  });

  return `
  <div class="s3d-flat-new__details">
    <div class="s3d-flat-new__details-top">
        <div class="s3d-flat-new__details-top-left">
            ${$infoLabels.join('')}
        </div>
        <div class="s3d-flat-new__details-top-right" ${
          sale == 1 ? `${TOOLTIP_ATTRIBUTE}="${i18n.t('unit_statuses.1_tooltip')}"` : ''
        }>
            <span>${i18n.t(`sales.${sale}`)}</span>
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M8 15C11.866 15 15 11.866 15 8C15 4.13404 11.866 1 8 1C4.13404 1 1 4.13404 1 8C1 11.866 4.13404 15 8 15ZM9.18356 11.7733L9.2942 11.2933L9.29417 11.2933C9.23716 11.3218 9.1449 11.3547 9.01758 11.3919C8.89016 11.4292 8.77617 11.4479 8.67562 11.4479C8.46108 11.4479 8.31015 11.4106 8.22303 11.3359C8.13581 11.2613 8.09225 11.1208 8.09225 10.9146C8.09225 10.8328 8.10568 10.7119 8.13255 10.552C8.15932 10.3919 8.18954 10.2497 8.22303 10.1253L8.63534 8.57322C8.67564 8.43105 8.70329 8.27465 8.71831 8.10388C8.73342 7.93323 8.74103 7.81412 8.74103 7.74665C8.74103 7.41948 8.63287 7.15371 8.41664 6.94932C8.20041 6.74481 7.89282 6.64256 7.49387 6.64256C7.2726 6.64256 7.0379 6.68436 6.78987 6.76796C6.54175 6.85144 6.28195 6.95191 6.01042 7.06925L5.89979 7.54926C5.98021 7.5172 6.07661 7.48347 6.18892 7.44795C6.30123 7.41233 6.41107 7.39463 6.51834 7.39463C6.73624 7.39463 6.88372 7.4337 6.96086 7.51196C7.03791 7.59011 7.07653 7.72883 7.07653 7.92787C7.07653 8.03819 7.06389 8.15992 7.0388 8.29329C7.01361 8.42655 6.98259 8.56799 6.94575 8.71727L6.53334 10.2746C6.4965 10.4382 6.46973 10.5849 6.45294 10.7146C6.43614 10.8444 6.42775 10.9715 6.42775 11.0959C6.42775 11.4159 6.53928 11.6799 6.76222 11.8879C6.98515 12.096 7.2978 12.2 7.70002 12.2C7.96159 12.2 8.19114 12.1635 8.38899 12.0906C8.58674 12.0177 8.85167 11.912 9.18356 11.7733ZM9.11056 5.47201C9.30338 5.28175 9.39979 5.05148 9.39979 4.78131C9.39979 4.5111 9.30337 4.28001 9.11056 4.08798C8.91784 3.89595 8.68571 3.79999 8.41407 3.79999C8.14251 3.79999 7.9096 3.89594 7.71511 4.08798C7.52072 4.28003 7.42342 4.51113 7.42342 4.78131C7.42342 5.05148 7.52072 5.28176 7.71511 5.47201C7.90962 5.66226 8.14254 5.75728 8.41407 5.75728C8.68571 5.75728 8.91784 5.66226 9.11056 5.47201Z" fill="#FAFBFE"/>
            </svg>
        </div>
    </div>
    ${areaContent}
    <div class="s3d-flat-new__details-price">
      <div>
        ${
          i18n.t('currency_label') === '$'
            ? `${i18n.t('currency_label_m2')} ${numberWithCommas(price_m2)}`
            : `${numberWithCommas(price_m2)} ${i18n.t('currency_label_m2')}`
        }
      </div>
      <div>
        ${
          i18n.t('currency_label') === '$'
            ? `${i18n.t('currency_label')} ${numberWithCommas(_price)}`
            : `${numberWithCommas(_price)} ${i18n.t('currency_label')}`
        }
      </div>
    </div>
    <div class="s3d-flat-new__details-buttons">
      <button class="js-s3d__create-pdf">
        <svg class="s3d-floor__nav-prev" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M10.8753 2.29154C10.813 2.2599 10.7057 2.23228 10.517 2.26385C10.2065 2.31578 10.0041 2.50094 9.87612 2.88739C9.73861 3.30254 9.71385 3.89569 9.78949 4.60604C9.89422 5.5896 10.1793 6.69582 10.4913 7.64906C10.8347 6.56033 11.1894 5.0918 11.2452 3.91602C11.2759 3.26752 11.2106 2.78938 11.0703 2.51194C11.006 2.38489 10.9378 2.32327 10.8753 2.29154ZM9.98145 9.17531C9.97968 9.17124 9.9779 9.16717 9.97612 9.1631L9.97295 9.15581L9.97 9.14842C9.51342 8.00282 8.9586 6.24725 8.79511 4.71192C8.71398 3.95003 8.72281 3.18895 8.92684 2.57297C9.14037 1.92829 9.5875 1.40543 10.352 1.27755C10.7007 1.21921 11.0339 1.25059 11.3279 1.39982C11.6217 1.54895 11.8258 1.79007 11.9626 2.06058C12.2245 2.57827 12.2767 3.27454 12.2441 3.96341C12.1775 5.36547 11.7371 7.0765 11.358 8.21853C11.2702 8.49546 11.1696 8.80009 11.057 9.12757C12.1388 11.4468 13.6067 13.101 15.108 14.2362C17.101 13.8606 18.3821 13.8581 19.3929 13.8581C20.7833 13.8581 21.8649 14.201 22.4012 14.8162C22.6871 15.144 22.821 15.5606 22.7125 15.9961C22.6093 16.4106 22.3081 16.7553 21.9105 17.0213C21.6485 17.1967 21.3065 17.2881 20.9489 17.3275C20.5823 17.3679 20.1564 17.3583 19.6925 17.2982C18.7641 17.1779 17.6464 16.8506 16.481 16.2657C15.9513 15.9999 15.4107 15.6803 14.8724 15.3017C13.3391 15.6165 11.3838 16.1547 8.81651 17.0747C8.24054 17.295 7.71031 17.5147 7.22286 17.7325C6.25974 19.398 5.18761 20.9043 4.05946 21.9142C3.44814 22.5232 2.73069 22.8471 2.118 22.7219C1.79045 22.6549 1.5048 22.4552 1.35593 22.1304C1.21358 21.8197 1.22712 21.4634 1.33529 21.1197C1.54905 20.4403 2.17743 19.6454 3.29001 18.8116C4.07876 18.2204 5.13423 17.592 6.51492 16.9556C6.9159 16.2458 7.30142 15.5016 7.66648 14.7471C8.62756 12.7606 9.42847 10.742 9.98145 9.17531ZM7.99551 16.3217C8.19198 15.944 8.38255 15.5631 8.56665 15.1826C9.36684 13.5287 10.0575 11.8546 10.5913 10.4252C11.5206 12.1387 12.6568 13.4785 13.8479 14.5034C12.4087 14.8405 10.654 15.3538 8.47415 16.1351L8.47412 16.135L8.4643 16.1387C8.30485 16.1997 8.14861 16.2607 7.99551 16.3217ZM5.53455 18.5665C4.87499 18.9295 4.33184 19.2805 3.88974 19.6118C2.84676 20.3935 2.41135 21.0315 2.28918 21.4198C2.22939 21.6098 2.25693 21.6961 2.26504 21.7138C2.26516 21.7141 2.26529 21.7144 2.26543 21.7148C2.26714 21.7195 2.27188 21.7327 2.3183 21.7421C2.45792 21.7707 2.8555 21.7058 3.36166 21.1978L3.37203 21.1874L3.383 21.1776C4.11644 20.5233 4.841 19.6172 5.53455 18.5665ZM16.3287 15.0474C16.5304 15.1642 16.7309 15.2723 16.9295 15.3719C18.0037 15.911 19.0137 16.2019 19.821 16.3065C20.225 16.3588 20.569 16.3633 20.8393 16.3335C21.1185 16.3027 21.2805 16.2397 21.3544 16.1902C21.6287 16.0067 21.7194 15.8457 21.7422 15.7544C21.7596 15.6842 21.7536 15.5951 21.6475 15.4733C21.4 15.1895 20.69 14.8581 19.3929 14.8581H19.3731C18.6075 14.8581 17.6684 14.8581 16.3287 15.0474Z" fill="#1A1E21"/>
        </svg>
        <span>${i18n.t('Flat.buttons.pdf')}</span>
      </button>
      <button class="js-s3d-add__favourite ${isChecked ? 'added-to-favourites' : ''}" data-id="${
    flat['id']
  }">
              <input type="checkbox" data-key="checked">
              ${s3d2spriteIcon('Compare')}
              <span title="${i18n.t('Flat.buttons.addedToCompare')}" data-in-fav>${i18n.t(
    'Flat.buttons.addedToCompare',
  )}</span>
                <span title="${i18n.t('Flat.buttons.compare')}" data-not-in-fav>${i18n.t(
    'Flat.buttons.compare',
  )}</span>
      </button>
      ${
        firstFlyby
          ? `<button class="" data-show-flat-in-flyby
        data-side="${firstFlyby[0].side}"
        data-control-point="${firstFlyby[0].controlPoint}"
        data-flyby="${firstFlyby[0].flyby}"
        data-type="flyby"
        change="true"
        data-flatid="${flat.id}">
        <svg style="margin-right: 8px;" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M4 5.75V6.3315V18.25L11.5001 22.7031L12.0001 23L12.5001 22.7031L20 18.25V6.33149V5.75L19.5103 5.45925L12.0001 1L4.48968 5.45926L4 5.75ZM5 6.92526V17.6808L11.5001 21.5401L11.4999 10.7846L5 6.92526ZM12.4999 10.7846L12.5001 21.5401L19 17.6808V6.92523L12.4999 10.7846ZM18.531 6.04074L12.0001 2.16299L5.46903 6.04076L11.9999 9.91851L18.531 6.04074Z" fill="#1A1E21"/>
        </svg>
        <span>${i18n?.t('Flat.buttons.showIn3d') || 'Show in 3D'}</span>
      </button>`
          : ''
      }
    </div>
    <button class="ButtonIconLeft active ButtonIconLeft--secondary text-uppercase-important" data-open-form="">
      <svg class="ButtonIconLeft__icon--no-paints" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="var(--color-gray-200)">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M6.88978 4.53638C6.88976 4.5364 6.88974 4.53642 6.88972 4.53644L5.0702 6.26193C5.0702 6.26193 5.07019 6.26194 5.07019 6.26194C4.63931 6.67057 4.45268 7.16852 4.51028 7.80011C4.57038 8.45913 4.90032 9.28114 5.56562 10.2726L5.56564 10.2727C6.64022 11.8743 8.25549 13.4085 8.96717 14.0835L8.96725 14.0835C9.5765 14.6615 11.3846 16.3734 13.2814 17.4795C14.4837 18.1804 15.4843 18.5 16.2706 18.5C16.9001 18.5 17.4162 18.296 17.8329 17.9008L19.4733 16.3452L19.8174 16.708L19.4733 16.3451C19.4939 16.3256 19.5 16.3067 19.5 16.2884C19.5 16.2689 19.4936 16.2508 19.4745 16.2327L19.4739 16.2321L16.1928 13.1207L16.5209 12.7747L16.1928 13.1207C16.1712 13.1002 16.1385 13.0847 16.0945 13.0847C16.0509 13.0847 16.0181 13.1 15.9959 13.1209C15.9958 13.1209 15.9958 13.121 15.9957 13.121L14.0498 14.9664L13.7586 15.2426L13.426 15.0181C12.4184 14.338 11.4421 13.5514 10.5239 12.6806L10.5239 12.6806C9.72806 11.9259 8.99577 11.1262 8.34712 10.303L8.06476 9.94469L8.39579 9.63076L10.3675 7.76095L10.3675 7.76094C10.3886 7.74097 10.3945 7.72085 10.3945 7.70432C10.3945 7.68778 10.3886 7.66749 10.3673 7.64734C10.3673 7.64733 10.3673 7.64733 10.3673 7.64732L7.08659 4.53627L7.08658 4.53626C7.06415 4.51498 7.02993 4.5 6.98835 4.5C6.9468 4.5 6.91243 4.51496 6.88978 4.53638ZM7.77469 3.81065C7.33781 3.39635 6.63887 3.39661 6.202 3.81047L6.20181 3.81065L4.38208 5.53633L4.38208 5.53633C3.71918 6.16499 3.43027 6.96823 3.51441 7.89093C3.59606 8.78622 4.02517 9.77162 4.73524 10.8298C5.87622 12.5304 7.56334 14.1303 8.27078 14.8012L8.27899 14.809L8.27907 14.8091L8.28183 14.8117C8.88857 15.3873 10.7708 17.1731 12.7776 18.3433L12.7777 18.3434C14.0532 19.0869 15.2336 19.5 16.2706 19.5C17.1404 19.5 17.9074 19.2083 18.521 18.6264L20.1614 17.0708C20.3763 16.867 20.5 16.5878 20.5 16.2884C20.5 15.9899 20.3775 15.7104 20.1616 15.5062C20.1615 15.5061 20.1614 15.506 20.1614 15.506L16.8809 12.3951C16.667 12.1922 16.3854 12.0847 16.0945 12.0847C15.8034 12.0847 15.5222 12.1924 15.3084 12.3947L15.308 12.395L13.6558 13.9619C12.8117 13.3675 11.9909 12.6937 11.212 11.955C10.565 11.3414 9.96336 10.6983 9.41876 10.0388L11.0556 8.48656C11.5075 8.058 11.5073 7.35064 11.0558 6.92207L11.0556 6.92188L7.7747 3.81065C7.77469 3.81065 7.77469 3.81065 7.77469 3.81065Z" stroke="none" fill="var(--color-gray-200)"/>
      </svg>
      <span>${i18n.t('ctr.nav.callback')}</span>
    </button>
  </div>`;
}
